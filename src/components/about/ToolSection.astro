---
import { Svg } from 'astro-pure/user'
import { cn } from 'astro-pure/utils'

interface Props {
  class?: string
  title: string
  tools: {
    name: string
    description: string
    href: string
<<<<<<< HEAD
<<<<<<< HEAD
    icon:
      | string
      | Promise<typeof import('*.svg?raw')>
      | ImageMetadata
    darkIcon?:
      | string
      | Promise<typeof import('*.svg?raw')>
      | ImageMetadata
=======
    icon: string // changed from Promise<typeof import('*.svg?raw')>
>>>>>>> parent of 4f1034b (test?)
=======
    icon: string // changed from Promise<typeof import('*.svg?raw')>
>>>>>>> parent of 4f1034b (test?)
  }[]
}

const { class: className, title, tools, ...props } = Astro.props
<<<<<<< HEAD
<<<<<<< HEAD

function isImageMetadata(obj: unknown): obj is ImageMetadata {
  return typeof obj === 'object' && obj !== null && 'src' in obj
}

function isString(obj: unknown): obj is string {
  return typeof obj === 'string'
}
=======
>>>>>>> parent of 4f1034b (test?)
=======
>>>>>>> parent of 4f1034b (test?)
---

<div
  class={cn(
    'not-prose flex flex-col rounded-xl border py-3 px-3 gap-y-3 sm:gap-y-4',
    className
  )}
  {...props}
>
  <div class='m-0 px-2 text-lg font-medium'>{title}</div>

  <div class='grid grid-cols-1 gap-x-2 gap-y-2 sm:grid-cols-2'>
    {
      tools.map((tool) => (
        <a
          class='group relative text-sm leading-normal no-underline'
          href={tool.href}
          id={tool.name}
          target='_blank'
        >
          <div class='flex items-center gap-x-3 rounded-lg border border-transparent px-1.5 py-1 transition-colors hover:border-border hover:bg-muted'>
<<<<<<< HEAD
<<<<<<< HEAD

            {/* ========== ICON RENDERING LOGIC ========== */}

            {tool.darkIcon ? (
              <>
                {/* LIGHT MODE */}
                <div class='size-10 rounded-lg bg-card p-2 dark:hidden'>
                  {isImageMetadata(tool.icon) ? (
                    <Image
                      src={tool.icon}
                      alt={tool.name}
                      class='h-full w-full object-contain'
                    />
                  ) : isString(tool.icon) ? (
                    <img
                      src={tool.icon}
                      alt={tool.name}
                      class='h-full w-full object-contain'
                      loading='lazy'
                    />
                  ) : (
                    <Svg
                      src={tool.icon}
                      class='h-full w-full fill-foreground'
                    />
                  )}
                </div>

                {/* DARK MODE */}
                <div class='size-10 rounded-lg bg-card p-2 hidden dark:block'>
                  {isImageMetadata(tool.darkIcon) ? (
                    <Image
                      src={tool.darkIcon}
                      alt={tool.name}
                      class='h-full w-full object-contain'
                    />
                  ) : isString(tool.darkIcon) ? (
                    <img
                      src={tool.darkIcon}
                      alt={tool.name}
                      class='h-full w-full object-contain'
                      loading='lazy'
                    />
                  ) : (
                    <Svg
                      src={tool.darkIcon}
                      class='h-full w-full fill-foreground'
                    />
                  )}
                </div>
              </>
            ) : (
              <div class='size-10 rounded-lg bg-card p-2'>
                {isImageMetadata(tool.icon) ? (
                  <Image
                    src={tool.icon}
                    alt={tool.name}
                    class='h-full w-full object-contain'
                  />
                ) : isString(tool.icon) ? (
                  <img
                    src={tool.icon}
                    alt={tool.name}
                    class='h-full w-full object-contain'
                    loading='lazy'
                  />
                ) : (
                  <Svg
                    src={tool.icon}
                    class='h-full w-full fill-foreground'
                  />
                )}
              </div>
            )}

            {/* ========== TEXT ========== */}

=======
=======
>>>>>>> parent of 4f1034b (test?)
            <img
              src={tool.icon}
              alt={tool.name}
              class='size-10 rounded-lg bg-primary-foreground p-2 object-contain'
              />
<<<<<<< HEAD
>>>>>>> parent of 4f1034b (test?)
=======
>>>>>>> parent of 4f1034b (test?)
            <div class='z-20 flex flex-col'>
              <div class='font-medium text-foreground'>{tool.name}</div>
              <div class='font-normal'>{tool.description}</div>
            </div>

          </div>
        </a>
      ))
    }
  </div>
</div>
